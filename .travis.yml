# GENERATED, DO NOT EDIT!
# To change, edit `build-support/bin/generate_travis_yml.py` and run:
# ./pants --quiet run build-support/bin:generate_travis_yml > .travis.yml


conditions: v1
deploy:
  'on':
    all_branches: true
    condition: $PREPARE_DEPLOY = 1
    repo: pantsbuild/pants
  provider: script
  script: ./build-support/bin/deploy_to_s3.py
  skip_cleanup: true
env:
  global:
  - PANTS_CONFIG_FILES="${TRAVIS_BUILD_DIR}/pants.travis-ci.ini"
  - LC_ALL="en_US.UTF-8"
  - BOOTSTRAPPED_PEX_BUCKET=ci-public.pantsbuild.org
  - BOOTSTRAPPED_PEX_KEY_PREFIX=${TRAVIS_BUILD_NUMBER}/${TRAVIS_BUILD_ID}/pants.pex
  - BOOTSTRAPPED_PEX_URL_PREFIX=s3://${BOOTSTRAPPED_PEX_BUCKET}/${BOOTSTRAPPED_PEX_KEY_PREFIX}
  - PYENV_PY27_VERSION=2.7.15
  - PYENV_PY36_VERSION=3.6.8
  - PYENV_PY37_VERSION=3.7.2
  - PYENV_ROOT="${PYENV_ROOT:-${HOME}/.pants_pyenv}"
  - PATH="${PYENV_ROOT}/shims:${PATH}"
  - AWS_CLI_ROOT="${HOME}/.aws_cli"
  - AWS_ACCESS_KEY_ID__TO_BE_REEXPORTED_ON_DEPLOYS=AKIAV6A6G7RQWPRUWIXR
  - secure: hFVAQGLVkexzTd3f9NF+JoG1dE+CPICKqOcdvQYv8+YB2rwwqu0/J6MnqKUZSmec4AM4ZvyPUBIHnSw8aMJysYs+GZ6iG/8ZRRmdbmo2WBPbSZ+ThRZxx/F6AjmovUmf8Zt366ZAZXpc9NHKREkTUGl6UL7FFe9+ouVnb90asdw=
  - RUST_BACKTRACE="all"
matrix:
  include:
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ulimit -c unlimited
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    dist: xenial
    env:
    - CACHE_NAME=bootstrap.linux.py36
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PREPARE_DEPLOY=1
    language: python
    name: Build Linux native engine and pants.pex (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - docker build --rm -t travis_ci --build-arg "BASE_IMAGE=pantsbuild/centos6:latest"
      --build-arg "TRAVIS_USER=$(id -un)" --build-arg "TRAVIS_UID=$(id -u)" --build-arg
      "TRAVIS_GROUP=$(id -gn)" --build-arg "TRAVIS_GID=$(id -g)" build-support/docker/travis_ci/
    - docker run --rm -t -v "${HOME}:/travis/home" -v "${TRAVIS_BUILD_DIR}:/travis/workdir"
      travis_ci:latest sh -c "./build-support/bin/ci.py --bootstrap --python-version
      3.6 && ./build-support/bin/release.sh -f"
    - aws --no-sign-request --region us-east-1 s3 cp ${TRAVIS_BUILD_DIR}/pants.pex
      ${BOOTSTRAPPED_PEX_URL_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    services:
    - docker
    stage: Bootstrap Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ulimit -c unlimited
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    dist: xenial
    env:
    - CACHE_NAME=bootstrap.linux.py37
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    language: python
    name: Build Linux native engine and pants.pex (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - docker build --rm -t travis_ci --build-arg "BASE_IMAGE=pantsbuild/centos7:latest"
      --build-arg "TRAVIS_USER=$(id -un)" --build-arg "TRAVIS_UID=$(id -u)" --build-arg
      "TRAVIS_GROUP=$(id -gn)" --build-arg "TRAVIS_GID=$(id -g)" build-support/docker/travis_ci/
    - docker run --rm -t -v "${HOME}:/travis/home" -v "${TRAVIS_BUILD_DIR}:/travis/workdir"
      travis_ci:latest sh -c "./build-support/bin/ci.py --bootstrap --python-version
      3.7"
    - aws --no-sign-request --region us-east-1 s3 cp ${TRAVIS_BUILD_DIR}/pants.pex
      ${BOOTSTRAPPED_PEX_URL_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    services:
    - docker
    stage: Bootstrap Pants (Cron)
    sudo: required
  - after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY36_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - CACHE_NAME=bootstrap.osx.py36
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.osx
    - PREPARE_DEPLOY=1
    language: generic
    name: Build OSX native engine and pants.pex (Python 3.6)
    os: osx
    osx_image: xcode8
    script:
    - ./build-support/bin/ci.py --bootstrap --python-version 3.6
    - ./build-support/bin/release.sh -f
    - aws --no-sign-request --region us-east-1 s3 cp ${TRAVIS_BUILD_DIR}/pants.pex
      ${BOOTSTRAPPED_PEX_URL_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    stage: Bootstrap Pants
  - after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY37_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY37_VERSION}/bin:${PATH}"
    - CACHE_NAME=bootstrap.osx.py37
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.osx
    language: generic
    name: Build OSX native engine and pants.pex (Python 3.7)
    os: osx
    osx_image: xcode8
    script:
    - ./build-support/bin/ci.py --bootstrap --python-version 3.7
    - aws --no-sign-request --region us-east-1 s3 cp ${TRAVIS_BUILD_DIR}/pants.pex
      ${BOOTSTRAPPED_PEX_URL_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    stage: Bootstrap Pants (Cron)
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ulimit -c unlimited
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    dist: xenial
    env:
    - CACHE_NAME=bootstrap.linux.py36
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PREPARE_DEPLOY=1
    language: python
    name: Build Linux native engine and pants.pex (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - docker build --rm -t travis_ci --build-arg "BASE_IMAGE=pantsbuild/centos6:latest"
      --build-arg "TRAVIS_USER=$(id -un)" --build-arg "TRAVIS_UID=$(id -u)" --build-arg
      "TRAVIS_GROUP=$(id -gn)" --build-arg "TRAVIS_GID=$(id -g)" build-support/docker/travis_ci/
    - docker run --rm -t -v "${HOME}:/travis/home" -v "${TRAVIS_BUILD_DIR}:/travis/workdir"
      travis_ci:latest sh -c "./build-support/bin/ci.py --bootstrap --python-version
      3.6 && ./build-support/bin/release.sh -f"
    - aws --no-sign-request --region us-east-1 s3 cp ${TRAVIS_BUILD_DIR}/pants.pex
      ${BOOTSTRAPPED_PEX_URL_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    services:
    - docker
    stage: Bootstrap Pants (Cron)
    sudo: required
  - after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY36_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - CACHE_NAME=bootstrap.osx.py36
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.osx
    - PREPARE_DEPLOY=1
    language: generic
    name: Build OSX native engine and pants.pex (Python 3.6)
    os: osx
    osx_image: xcode8
    script:
    - ./build-support/bin/ci.py --bootstrap --python-version 3.6
    - ./build-support/bin/release.sh -f
    - aws --no-sign-request --region us-east-1 s3 cp ${TRAVIS_BUILD_DIR}/pants.pex
      ${BOOTSTRAPPED_PEX_URL_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    stage: Bootstrap Pants (Cron)
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - wget -qO- "https://github.com/crazy-max/travis-wait-enhanced/releases/download/v0.2.1/travis-wait-enhanced_0.2.1_linux_x86_64.tar.gz"
      | tar -zxvf - travis-wait-enhanced
    - mv travis-wait-enhanced /home/travis/bin/
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=unit_tests.py37
    language: python
    name: Unit tests (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - travis-wait-enhanced --timeout 65m --interval 9m -- ./build-support/bin/ci.py
      --unit-tests --plugin-tests --remote-execution-enabled --python-version 3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - wget -qO- "https://github.com/crazy-max/travis-wait-enhanced/releases/download/v0.2.1/travis-wait-enhanced_0.2.1_linux_x86_64.tar.gz"
      | tar -zxvf - travis-wait-enhanced
    - mv travis-wait-enhanced /home/travis/bin/
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v2.py37
    language: python
    name: Integration tests - V2 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - travis-wait-enhanced --timeout 65m --interval 9m -- ./build-support/bin/ci.py
      --integration-tests-v2 --remote-execution-enabled --python-version 3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=lint.py36
    language: python
    name: Self-checks and lint (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --githooks --sanity-checks --doc-gen --lint --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=lint.py37
    language: python
    name: Self-checks and lint (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --githooks --sanity-checks --doc-gen --lint --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - sudo apt-get install -y pkg-config fuse libfuse-dev
    - sudo modprobe fuse
    - sudo chmod 666 /dev/fuse
    - sudo chown root:$USER /etc/fuse.conf
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    dist: xenial
    env:
    - CACHE_NAME=clippy
    name: Clippy (Rust linter)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --clippy
    stage: Test Pants
    sudo: required
  - before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - sudo apt-get install -y pkg-config fuse libfuse-dev
    - sudo modprobe fuse
    - sudo chmod 666 /dev/fuse
    - sudo chown root:$USER /etc/fuse.conf
    dist: xenial
    env:
    - CACHE_NAME=cargo_audit
    name: Cargo audit
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --cargo-audit
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - wget -qO- "https://github.com/crazy-max/travis-wait-enhanced/releases/download/v0.2.1/travis-wait-enhanced_0.2.1_linux_x86_64.tar.gz"
      | tar -zxvf - travis-wait-enhanced
    - mv travis-wait-enhanced /home/travis/bin/
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=unit_tests.py36
    language: python
    name: Unit tests (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - travis-wait-enhanced --timeout 65m --interval 9m -- ./build-support/bin/ci.py
      --unit-tests --plugin-tests --remote-execution-enabled --python-version 3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - wget -qO- "https://github.com/crazy-max/travis-wait-enhanced/releases/download/v0.2.1/travis-wait-enhanced_0.2.1_linux_x86_64.tar.gz"
      | tar -zxvf - travis-wait-enhanced
    - mv travis-wait-enhanced /home/travis/bin/
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v2.py36
    language: python
    name: Integration tests - V2 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - travis-wait-enhanced --timeout 65m --interval 9m -- ./build-support/bin/ci.py
      --integration-tests-v2 --remote-execution-enabled --python-version 3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    - ulimit -c unlimited
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PREPARE_DEPLOY=1
    - CACHE_NAME=wheels.linux.py36
    language: python
    name: Build Linux wheels (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - docker build --rm -t travis_ci --build-arg "BASE_IMAGE=pantsbuild/centos6:latest"
      --build-arg "TRAVIS_USER=$(id -un)" --build-arg "TRAVIS_UID=$(id -u)" --build-arg
      "TRAVIS_GROUP=$(id -gn)" --build-arg "TRAVIS_GID=$(id -g)" build-support/docker/travis_ci/
    - docker run --rm -t -v "${HOME}:/travis/home" -v "${TRAVIS_BUILD_DIR}:/travis/workdir"
      travis_ci:latest sh -c "./build-support/bin/check_pants_pex_abi.py abi3 cp36m
      && RUN_PANTS_FROM_PEX=1 ./build-support/bin/release.sh -n"
    services:
    - docker
    stage: Test Pants
    sudo: required
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY36_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.osx
    - PREPARE_DEPLOY=1
    - CACHE_NAME=wheels.osx.py36
    - PY=${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin/python
    - PANTS_PYTHON_SETUP_INTERPRETER_CONSTRAINTS="['CPython==${PYENV_PY36_VERSION}']"
    language: generic
    name: Build OSX wheels (Python 3.6)
    os: osx
    osx_image: xcode8
    script:
    - ./build-support/bin/check_pants_pex_abi.py abi3 cp36m
    - RUN_PANTS_FROM_PEX=1 ./build-support/bin/release.sh -n
    stage: Test Pants
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_0.py36
    language: python
    name: Integration tests  - V1 - shard 0 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 0/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_1.py36
    language: python
    name: Integration tests  - V1 - shard 1 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 1/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_2.py36
    language: python
    name: Integration tests  - V1 - shard 2 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 2/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_3.py36
    language: python
    name: Integration tests  - V1 - shard 3 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 3/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_4.py36
    language: python
    name: Integration tests  - V1 - shard 4 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 4/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_5.py36
    language: python
    name: Integration tests  - V1 - shard 5 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 5/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_6.py36
    language: python
    name: Integration tests  - V1 - shard 6 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 6/7 --python-version
      3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_0.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 0 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 0/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_1.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 1 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 1/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_2.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 2 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 2/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_3.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 3 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 3/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_4.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 4 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 4/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_5.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 5 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 5/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=integration.v1.shard_6.py36.pantsd
    - USE_PANTSD_FOR_INTEGRATION_TESTS="true"
    language: python
    name: Integration tests with Pantsd - V1 - shard 6 (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 6/7 --python-version
      3.6
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_0.py37
    language: python
    name: Integration tests  - V1 - shard 0 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 0/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_1.py37
    language: python
    name: Integration tests  - V1 - shard 1 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 1/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_2.py37
    language: python
    name: Integration tests  - V1 - shard 2 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 2/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_3.py37
    language: python
    name: Integration tests  - V1 - shard 3 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 3/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_4.py37
    language: python
    name: Integration tests  - V1 - shard 4 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 4/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_5.py37
    language: python
    name: Integration tests  - V1 - shard 5 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 5/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=integration.v1.shard_6.py37
    language: python
    name: Integration tests  - V1 - shard 6 (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --integration-tests-v1 --integration-shard 6/7 --python-version
      3.7
    stage: Test Pants (Cron)
    sudo: required
  - before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - sudo apt-get install -y pkg-config fuse libfuse-dev
    - sudo modprobe fuse
    - sudo chmod 666 /dev/fuse
    - sudo chown root:$USER /etc/fuse.conf
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    dist: xenial
    env:
    - CACHE_NAME=rust_tests.linux
    name: Rust tests - Linux
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --rust-tests
    stage: Test Pants
    sudo: required
  - before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find build-support -name "*.py[co]" -delete
    before_install:
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY36_VERSION}"
    - brew cask install osxfuse
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/rust/cargo
      - build-support/virtualenvs
      - src/rust/engine/target
      timeout: 500
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - CACHE_NAME=rust_tests.osx
    name: Rust tests - OSX
    os: osx
    osx_image: xcode8.3
    script:
    - ./build-support/bin/ci.py --rust-tests
    stage: Test Pants
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY36_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.osx
    - CACHE_NAME=osx_platform_tests.py36
    language: generic
    name: OSX platform-specific tests (Python 3.6)
    os: osx
    script:
    - ./build-support/bin/ci.py --platform-specific-tests --python-version 3.6
    stage: Test Pants
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY37_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY37_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.osx
    - CACHE_NAME=osx_platform_tests.py37
    language: generic
    name: OSX platform-specific tests (Python 3.7)
    os: osx
    script:
    - ./build-support/bin/ci.py --platform-specific-tests --python-version 3.7
    stage: Test Pants (Cron)
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY36_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.osx
    - CACHE_NAME=osx_sanity.10_12.py36
    language: generic
    name: OSX 10.12 sanity check (Python 3.6)
    os: osx
    osx_image: xcode9.2
    script:
    - MODE=debug ./build-support/bin/ci.py --sanity-checks --python-version 3.6
    stage: Test Pants
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY37_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY37_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.osx
    - CACHE_NAME=osx_sanity.10_12.py37
    language: generic
    name: OSX 10.12 sanity check (Python 3.7)
    os: osx
    osx_image: xcode9.2
    script:
    - MODE=debug ./build-support/bin/ci.py --sanity-checks --python-version 3.7
    stage: Test Pants (Cron)
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY36_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY36_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.osx
    - CACHE_NAME=osx_sanity.10_13.py36
    language: generic
    name: OSX 10.13 sanity check (Python 3.6)
    os: osx
    osx_image: xcode10.1
    script:
    - MODE=debug ./build-support/bin/ci.py --sanity-checks --python-version 3.6
    stage: Test Pants
  - before_install:
    - curl -L https://github.com/stedolan/jq/releases/download/jq-1.5/jq-osx-amd64
      -o /usr/local/bin/jq
    - chmod 755 /usr/local/bin/jq
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - ./build-support/bin/install_python_for_ci.sh "${PYENV_PY27_VERSION}" "${PYENV_PY37_VERSION}"
    before_script:
    - ulimit -c unlimited
    - ulimit -n 8192
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    env:
    - PATH="/usr/local/opt/openssl/bin:${PATH}"
    - LDFLAGS="-L/usr/local/opt/openssl/lib"
    - CPPFLAGS="-I/usr/local/opt/openssl/include"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY27_VERSION}/bin:${PATH}"
    - PATH="${PYENV_ROOT}/versions/${PYENV_PY37_VERSION}/bin:${PATH}"
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.osx
    - CACHE_NAME=osx_sanity.10_13.py37
    language: generic
    name: OSX 10.13 sanity check (Python 3.7)
    os: osx
    osx_image: xcode10.1
    script:
    - MODE=debug ./build-support/bin/ci.py --sanity-checks --python-version 3.7
    stage: Test Pants (Cron)
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - sudo apt-get install -y pkg-config fuse libfuse-dev
    - sudo modprobe fuse
    - sudo chmod 666 /dev/fuse
    - sudo chown root:$USER /etc/fuse.conf
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py36.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - CACHE_NAME=jvm_tests.py36
    language: python
    name: JVM tests (Python 3.6)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --jvm-tests --python-version 3.6
    stage: Test Pants
    sudo: required
  - addons:
      apt:
        packages:
        - lib32stdc++6
        - lib32z1
        - lib32z1-dev
        - gcc-multilib
        - python-dev
        - openssl
        - libssl-dev
        - jq
        - unzip
        - shellcheck
    after_failure:
    - ./build-support/bin/ci-failure.sh
    before_cache:
    - sudo chown -R travis:travis "${HOME}" "${TRAVIS_BUILD_DIR}"
    - find ${HOME}/.ivy2/pants -type f -name "ivydata-*.properties" -delete
    - rm -f ${HOME}/.ivy2/pants/*.{css,properties,xml,xsl}
    - rm -rf ${HOME}/.ivy2/pants/com.example
    - du -m -d2 ${HOME}/.cache/pants | sort -r -n
    before_install:
    - PATH="/usr/lib/jvm/java-8-openjdk-amd64/jre/bin":$PATH
    - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
    - sudo sysctl fs.inotify.max_user_watches=524288
    - ./build-support/bin/install_aws_cli_for_ci.sh
    - pyenv global 2.7.15 3.6.7 3.7.1
    - sudo apt-get install -y pkg-config fuse libfuse-dev
    - sudo modprobe fuse
    - sudo chmod 666 /dev/fuse
    - sudo chown root:$USER /etc/fuse.conf
    before_script:
    - ./build-support/bin/get_ci_bootstrapped_pants_pex.sh ${BOOTSTRAPPED_PEX_BUCKET}
      ${BOOTSTRAPPED_PEX_KEY_PREFIX}.${BOOTSTRAPPED_PEX_KEY_SUFFIX}
    cache:
      directories:
      - ${AWS_CLI_ROOT}
      - ${PYENV_ROOT}
      - ${HOME}/.cache/pants/lmdb_store
      - ${HOME}/.cache/pants/tools
      - ${HOME}/.cache/pants/zinc
      - ${HOME}/.ivy2/pants
      - ${HOME}/.npm
      timeout: 500
    dist: xenial
    env:
    - BOOTSTRAPPED_PEX_KEY_SUFFIX=py37.linux
    - PANTS_REMOTE_CA_CERTS_PATH=/usr/lib/google-cloud-sdk/lib/third_party/grpc/_cython/_credentials/roots.pem
    - PANTS_NATIVE_BUILD_STEP_CPP_COMPILE_SETTINGS_DEFAULT_COMPILER_OPTION_SETS="[]"
    - CACHE_NAME=jvm_tests.py37
    language: python
    name: JVM tests (Python 3.7)
    os: linux
    python:
    - '2.7'
    - '3.6'
    - '3.7'
    script:
    - ./build-support/bin/ci.py --jvm-tests --python-version 3.7
    stage: Test Pants (Cron)
    sudo: required
  - before_install:
    - pyenv global 3.6.3
    deploy:
      api_key:
        secure: u0aCsiuVGOg28YxG0sQUovuUm29kKwQfFgHbNz2TT5L+cGoHxGl4aoVOCtuwWYEtbNGmYc8/3WRS3C/jOiqQj6JEgHUzWOsnfKUObEqNhisAmXbzBbKc0wPQTL8WNK+DKFh32sD3yPYcw+a5PTLO56+o7rqlI25LK7A17WesHC4=
      file: dist/deploy/pex/*
      file_glob: true
      'on':
        repo: pantsbuild/pants
        tags: true
      provider: releases
      skip_cleanup: true
    dist: trusty
    env:
    - RUN_PANTS_FROM_PEX=1
    - PANTS_PEX_RELEASE=stable
    - CACHE_NAME=deploy.stable
    language: python
    name: Deploy stable pants.pex (Python 3.6)
    os: linux
    python:
    - '3.6'
    script:
    - ./build-support/bin/release.sh -p
    stage: Deploy Pants Pex
  - before_install:
    - pyenv global 3.6.3
    dist: trusty
    env:
    - RUN_PANTS_FROM_PEX=1
    - PREPARE_DEPLOY=1
    - CACHE_NAME=deploy.unstable
    language: python
    name: Deploy unstable pants.pex (Python 3.6)
    os: linux
    python:
    - '3.6'
    script:
    - ./build-support/bin/release.sh -p
    - mkdir -p dist/deploy/pex/
    - mv dist/pants*.pex dist/deploy/pex/
    stage: Deploy Pants Pex Unstable
stages:
- if: type != cron
  name: Bootstrap Pants
- if: type = cron
  name: Bootstrap Pants (Cron)
- if: type != cron
  name: Test Pants
- if: type = cron
  name: Test Pants (Cron)
- if: tag IS present AND tag =~ ^release_.*$
  name: Deploy Pants Pex
- if: tag IS NOT present AND type NOT IN (pull_request, cron)
  name: Deploy Pants Pex Unstable

