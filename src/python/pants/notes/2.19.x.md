# 2.19.x Release Series

Pants 2 is a fast, scalable, user-friendly build system for codebases of all sizes. It's currently focused on Python, Go, Java, Scala, Kotlin, Shell, and Docker, with support for other languages and frameworks coming soon.

Individuals and companies can now [sponsor Pants financially](https://www.pantsbuild.org/docs/sponsorship).

Pants is an open-source project that is not owned or controlled by any one company or organization, and does incur some expenses. These expenses are managed by Pants Build, a non-profit that was established for this purpose. This non-profit's only source of revenue is sponsorship by individuals and companies that use Pants.

We offer [formal sponsorship tiers for companies](https://www.pantsbuild.org/docs/sponsorship), as well as individual sponsorships via [GitHub](https://github.com/sponsors/pantsbuild).

## What's New

### Highlights

### Overall

### BUILD files

[The `parametrize` helper](https://www.pantsbuild.org/v2.19/docs/targets#parametrizing-targets) now supports parametrizing multiple fields together, in lock step. For instance:

``` python
# Creates two targets:
#
#    example:tests@parametrize=py2
#    example:tests@parametrize=py3

python_test(
    name="tests",
    source="tests.py",
    **parametrize("py2", interpreter_constraints=["==2.7.*"], resolve="lock-a"),
    **parametrize("py3", interpreter_constraints=[">=3.6,<3.7"], resolve="lock-b"),
)
```

In addition, `parametrize` can now be used with a single value (`field=parametrize("for-consistency")`), and now works on target generations in more cases (particularly those with "plugin" fields).

### Performance

### Remote caching/execution

Large files that need to be stored to a remote cache are now streamed to it directly from disk, in a way that should reduce overhead and increase concurrency ([#19711](https://github.com/pantsbuild/pants/pull/19711)).

### Backends

#### Docker

The [docker backend](https://www.pantsbuild.org/v2.19/docs/docker) now has explicit support for using [`buildx` (and thus BuildKit)](https://github.com/docker/buildx#buildx), via [the new `use_buildx` option](https://www.pantsbuild.org/v2.19/docs/reference-docker#use_buildx). This also allows adding few additional fields for [`docker_image` targets](https://www.pantsbuild.org/v2.19/docs/reference-docker_image), for `buildx`-specific functionality:

- [`cache_from` and `cache_to`](https://www.pantsbuild.org/v2.19/docs/docker#external-cache-storage-backends) for using external cache storage backends
- [`output`](https://www.pantsbuild.org/v2.19/docs/reference-docker_image#codeoutputcode) to control how/where `buildx` outputs an image when running `pants package ::`

#### JVM

JVM lock-files are more reliable, handling [some cases](https://github.com/pantsbuild/pants/issues/20162) of Coursier not including dependencies when expected.

Using [`shading_rules`](https://www.pantsbuild.org/v2.19/docs/reference-deploy_jar#codeshading_rulescode) is now supported on `deploy_jar` targets defined in directories of the build root.

##### Kotlin

The Kotlin analyzer now runs using the Zulu JDK, to be able to run natively on Apple Silicon (arm64 macOS).

##### Java

Dependency inference for Java now supports code using recently added syntax like `sealed class` & `permits`, `switch` expressions and `yield`.

##### Scala

Scala 3 is now supported when using [the BSP in an IDE](https://www.pantsbuild.org/v2.19/docs/jvm-overview#working-in-an-ide).

#### Python

**Deprecation**: Using the `platforms` field on `pex_binary` is now deprecated. It is not a recommended way to build for platforms other than the local one, as it is a lossy abbreviation of the target platform and often leads to binaries that don't work. To replace this, either [use `complete_platforms` to continue cross-compiling](https://www.pantsbuild.org/v2.19/docs/pex#setting-the-target-platforms-for-a-pex) or use [an environment matching the target platform](https://www.pantsbuild.org/v2.19/docs/environments).

Pants now uses version 2.1.148 of the PEX CLI by default, which includes support for Python 3.12.

Python interpreters provided by ASDF are now searched by default, in addition those provided by pyenv and on the system `PATH`, by being included in the [`[python-bootstrap].search_path`](https://www.pantsbuild.org/v2.19/docs/reference-python-bootstrap#search_path) option.

Many more "groups" of PyPI dependencies have default module mappings that guide how an `import` statement in code matches particular `python_requirement`s. All packages from the `azure-...`, `django-...`, `google-cloud-...`, `opentelemetry-instrumentation-...`, `oslo-...` ecosystems are now matched to modules matching their usual conventions. In addition, packages starting with `python-...` now have that `python-` prefix removed by default: for instance, a package like `python-example-name` will be implicitly assumed to be imported like `import example_name`. [The value of any `module_mapping` field](https://www.pantsbuild.org/v2.19/docs/reference-python_requirements#codemodule_mappingcode) can thus be tweaked (hopefully simplified!).

Additional features and fixes:

- [Additional arguments](https://www.pantsbuild.org/v2.19/docs/reference-repl#args) can be passed to the IPython REPL, like `pants repl --shell=ipython :: -- -i helloworld/main.py`.
- Additional arguments can be passed to the underlying PEX invocations when building FaaS artifacts ([AWS Lambda](https://www.pantsbuild.org/v2.19/docs/awslambda-python), [Google Cloud Functions](https://www.pantsbuild.org/v2.19/docs/google-cloud-function-python)) via the new [`pex3_venv_create_extra_args`](https://www.pantsbuild.org/v2.19/docs/reference-python_aws_lambda_function#codepex3_venv_create_extra_argscode) field. For instance, if  dependencies have packaged files in unexpected locations, passing  `pex3_venv_create_extra_args=["--collisions-ok"]` can side-step collision errors.
- The [`pip_version`](https://www.pantsbuild.org/v2.19/docs/reference-python#pip_version) field no longer restricts the values, and so allows more flexibility when upgrading the PEX CLI if it supports newer Pip versions.
- Running tests or `pants run` a source file now make binaries provided by `python_requirement` available for execution as normal processes (for instance, using `subprocess.run(["name-of-binary", ...])`).
- The `PATH` environment variable can now be set using [`[subprocess-environment].env_vars`](https://www.pantsbuild.org/v2.19/docs/reference-subprocess-environment#env_vars)
- Import statements within a `with contextlib.suppress(ImportError)` context are now weak, and so no longer warn if not provided by a dependency.
- Computing an aggregate coverage sandbox report is now more reliable in the presence of name collisions in files created via code-generation (including `relocated_files`).
- Pyright (`pants.backend.experimental.python.typecheck.pyright`) now runs with an appropriately initialised environment and so runs more reliably (especially in transient CI environments, where "named caches" might not be preserved).
- [Ruff (`pants.backend.experimental.python.lint.ruff`)](https://www.pantsbuild.org/v2.19/docs/reference-ruff) now properly respects any `exclude` configuration from `ruff.toml` or `pyproject.toml`.

The following code has been removed, because deprecations have expired:

- Support for building FaaS artifacts ([AWS Lambda](https://www.pantsbuild.org/v2.19/docs/awslambda-python), [Google Cloud Functions](https://www.pantsbuild.org/v2.19/docs/google-cloud-function-python)) via Lambdex has been fully replaced with the new `zip` layout: remove the `[lambdex]` section and its `layout` setting from `pants.toml`.
- Dependency inference now only supports running with the new Rust-based parser. That is, the `[python-infer].use_rust_parser` option cannot be disabled and is now unnecessary.

## Full Changelog

For the full changelog, see the individual GitHub Releases for this series: https://github.com/pantsbuild/pants/releases

# release_2.19.0rc2

## New Features

## Bug Fixes

* fix: terraform_relpath works on files not in direct subpath (Cherry-pick of #20276) ([#20300](https://github.com/pantsbuild/pants/pull/20300))

* Fix: run `terraform validate` on modules again (Cherry-pick of #20230) ([#20298](https://github.com/pantsbuild/pants/pull/20298))

# release_2.19.0rc1

## Bug Fixes

* Use fork of indicatif to work around output truncation (Cherry-pick of #20269) ([#20277](https://github.com/pantsbuild/pants/pull/20277))

# release_2.19.0rc0

## Bug Fixes

* Remove print() statement (Cherry-pick of #20196) ([#20203](https://github.com/pantsbuild/pants/pull/20203))

* Do not choke on values from macros on environment targets during bootstrap. (Cherry-pick of #20191) ([#20198](https://github.com/pantsbuild/pants/pull/20198))

## Documentation

* Add note in docker_environment image field help on tool requirements (Cherry-pick of #20231) ([#20235](https://github.com/pantsbuild/pants/pull/20235))

# release_2.19.0a0

## New Features

## User API Changes

## Bug Fixes

* Fix `protobuf_sources` with parametrized `python_resolve` ([#20069](https://github.com/pantsbuild/pants/pull/20069))

## Documentation

* Update docs with get-pants.sh new install location: `~/.local/bin` ([#20155](https://github.com/pantsbuild/pants/pull/20155))

# release_2.19.0.dev4

## New Features

* Add `TransitivelyExcludeDependenciesRequest` to mirror user-provided values ([#20080](https://github.com/pantsbuild/pants/pull/20080))

* Use `ambiguity-resolution` for Python protobuf/grpc dependency inference ([#19939](https://github.com/pantsbuild/pants/pull/19939))

## Documentation

* vscode: add rust settings to suggested configuration in docs ([#20094](https://github.com/pantsbuild/pants/pull/20094))

# release_2.19.0.dev3

## New Features

* Optionally retry failed tests ([#19760](https://github.com/pantsbuild/pants/pull/19760))

* Create system-binaries subsystem ([#19377](https://github.com/pantsbuild/pants/pull/19377))

## Bug Fixes

* Fix protoc support on M1 mac ([#20058](https://github.com/pantsbuild/pants/pull/20058))

## Documentation

* doc: Some guidance on auto-fixing goals in CI ([#20040](https://github.com/pantsbuild/pants/pull/20040))

* docs: remove reference to `use_deprecated_directory_cli_args_semantics` ([#20041](https://github.com/pantsbuild/pants/pull/20041))

* Specify pants as running with cp3.9 only in plugin docs ([#20003](https://github.com/pantsbuild/pants/pull/20003))

# release_2.19.0.dev2

## New Features

## Plugin API Changes

* Always have coloured output and then strip later for pytest, helm unittest, shunit2 ([#19923](https://github.com/pantsbuild/pants/pull/19923))

## Bug Fixes

* Fix Buf expected configuration files ([#18015](https://github.com/pantsbuild/pants/pull/18015))

* Don't crash in the presence of non-UTF-8 env vars. ([#19926](https://github.com/pantsbuild/pants/pull/19926))

## Documentation

* Fix "the the" typos in the codebase. ([#19967](https://github.com/pantsbuild/pants/pull/19967))

# release_2.19.0.dev1

## User API Changes

* Move .pids under .pants.d by default ([#19911](https://github.com/pantsbuild/pants/pull/19911))

* Enable lockfile diff report by default. ([#19900](https://github.com/pantsbuild/pants/pull/19900))

## Bug Fixes

# release_2.19.0.dev0

## New Features

* Add lint backend to run semgrep ([#18593](https://github.com/pantsbuild/pants/pull/18593))

* Add support for openapi-format ([#18553](https://github.com/pantsbuild/pants/pull/18553))

## User API Changes

* Remove deprecations scheduled for 2.19.0.dev0. ([#19759](https://github.com/pantsbuild/pants/pull/19759))

## Plugin API Changes

* Optionally resolve rules by a provided id ([#19755](https://github.com/pantsbuild/pants/pull/19755))

* Remove TestResult.{stdout,stderr} and all uses. ([#19768](https://github.com/pantsbuild/pants/pull/19768))

## Bug Fixes

* Tweak `fix` partitioning to closer align to `lint` partitioning ([#19796](https://github.com/pantsbuild/pants/pull/19796))

## Documentation

* docs: add chat archive link, more talks, more example repos ([#19679](https://github.com/pantsbuild/pants/pull/19679))

* Instructions: pants repo debugging with pycharm ([#19787](https://github.com/pantsbuild/pants/pull/19787))

* generate toml for reference-docs ([#19718](https://github.com/pantsbuild/pants/pull/19718))

* Remove Toolchain from who uses Pants page ([#19747](https://github.com/pantsbuild/pants/pull/19747))

* Remove `PANTS_SHA` from docs ([#19719](https://github.com/pantsbuild/pants/pull/19719))
