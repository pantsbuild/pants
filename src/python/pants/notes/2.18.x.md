# 2.18.x Release Series

❗❗❗ This project is no longer being released via PyPI, and is instead released via GitHub Releases. See https://github.com/pantsbuild/pants/releases

Individuals and companies can now [sponsor Pants financially](https://www.pantsbuild.org/docs/sponsorship).

Pants is an open-source project that is not owned or controlled by any one company or organization, and does incur some expenses. These expenses are managed by Pants Build, a non-profit that was established for this purpose. This non-profit's only source of revenue is sponsorship by individuals and companies that use Pants.

We offer [formal sponsorship tiers for companies](https://www.pantsbuild.org/docs/sponsorship), as well as individual sponsorships via [GitHub](https://github.com/sponsors/pantsbuild).

## What's New

### Overall

[The `pants` launcher binary](https://www.pantsbuild.org/v2.18/docs/installation) is now required to run Pants. It must be version 0.10.0 or greater: run `PANTS_BOOTSTRAP_VERSION=report pants` to check and `SCIE_BOOT=update pants` to upgrade to the latest. Pants 2.18 and later are not distributed via PyPI, and thus the launcher is required to coordinate downloading the appropriate versions from GitHub Releases.

[The `[cli.alias]` section](https://www.pantsbuild.org/v2.18/docs/reference-cli) of `pants.toml` now supports defining flag-like aliases. For example: `--all-changed = "--changed-since=HEAD --changed-dependents=transitive"`.

[The `paths` goal](https://www.pantsbuild.org/v2.18/docs/reference-paths) now supports passing groups of targets to `--from` and/or `--to`.

The `help` goal now supports showing help for an environment variable. For example: `pants help PANTS_FIX_ONLY`.

Numerous bug fixes, including:

- The client now detects changes in pants configuration that require restarting the pants daemon.
- Sequences of goals that mutate files on disk and then immediately re-read them now no longer fail spuriously if the second goal happens faster than the OS file-change notification is received. For instance, `pants fix lint ::` would sometimes run the `lint` goal on the files before the `fix` changes were applied.
- More reliable detection of when optimised hard-linking can be used for creating sandboxes. For instance, no longer hitting errors when a single device is mounted multiple times.

The deprecation for referring to a "secondary" owner target via the file name has expired, and so this is no longer supported. For example, if `path/to/main.py` is the entry point of the `path/to:binary` `pex_binary` target, an invocation like `pants package path/to/main.py` must now use the target address instead: `pants package path/to:binary`.

### BUILD files

Several bug fixes, including:

- Better error messages when a `BUILD` file refers to an unknown value.
- `__defaults__` can now be used in the same `BUILD` file as [environment targets](https://www.pantsbuild.org/v2.18/docs/environments) like `local_environment`.

### Performance

Memory usage has been reduced, particularly for the Go backend.

### Remote caching/execution

Remote caching using the gRPC remote execution API now supports mTLS, via the new [`remote_client_certs_path`](https://www.pantsbuild.org/v2.18/docs/reference-global#remote_client_certs_path) and [`remote_client_key_path`](https://www.pantsbuild.org/v2.18/docs/reference-global#remote_client_key_path) options in the `[GLOBAL]` section.

### Backends

Several backends that were intended to be included in previous releases were accidentally missing from the released pants artifacts, these are now available in 2.18:

- `pants.backend.experimental.openapi.codegen.java`: Enables generating Java from OpenAPI.
- `pants.backend.experimental.python.framework.django`: Enables better support for projects using Django.
- `pants.backend.experimental.swift`: Enables core Swift support.
- `pants.backend.python.providers.experimental.pyenv.custom_install`: Enables customising how the pyenv provider builds a Python interpreter.

In addition, the [documentation of backends](https://www.pantsbuild.org/v2.18/docs/enabling-backends) now lists all backends, including preview ones that were not previously advertised. Please go check it out, try backends relevant to you and let us know how they go for your use cases, [report bugs](https://www.pantsbuild.org/v2.18/docs/getting-help) and/or [submit fixes](https://www.pantsbuild.org/v2.18/docs/contributor-overview)!

#### Docker

raw: Add Docker global no build cache option (#19533)

raw: Add build platform and hosts options to docker_image target (#19475)

raw: Add build_network option to docker_image target (#19354)

raw: Raise error for conflicting Docker registries (#19344)

raw: docker_image: secrets paths are now expanding ~ to the users home directory. (#19130)

#### Helm

raw: add latest helm versions; upgrade default (#19592)

raw: Support Helm unittest snapshots (#19264)
raw: Support discarding inferred Helm snapshot dependencies (#19527)

raw: Implement Helm chart versioning (#19493)

raw: Add Support for Kubeconform in Helm backend (#19427)

raw: Resolve Docker addresses relative to the helm_deployment (#19455)

raw: Deprecate old value interpolation in Helm deployments (#19302)

raw: Helm deployment chart field (#19234)

raw: pass "--debug" flag to all helm invocations if requested (#19093)

#### JavaScript

raw: Enable env vars in node_build_script (#19100)

raw: javascript: Allow nodejs-backed tools to point to a resolve and/or package manager (#19040)

raw: javascript: Rust based dep inference for javascript (#18985)

#### Python

The functions-as-a-service (FaaS) backends, [`pants.backend.awslambda.python`](https://www.pantsbuild.org/v2.18/docs/awslambda-python) and [`pants.backend.google_cloud_function.python`](https://www.pantsbuild.org/v2.18/docs/google-cloud-function-python) have seen more improvements in 2.18:

- Deprecation: the `python_awslambda` target has been renamed to `python_aws_lambda_function`.
- Deprecation: the `[lambdex].layout = "zip"` value in `pants.toml` is now the default, and the `[lambdex]` section should be removed.
- New: [the `python_aws_lambda_layer` target](https://www.pantsbuild.org/v2.18/docs/awslambda-python#building-a-lambda-layer) can be used to build Layers for AWS Lambda.
- New: the `runtime` field is no longer necessary when the interpreter constraints unambiguously refer to an entire single major version. For instance, with `[python].interpreter_constraints = ["==3.11.*"]`, one doesn't need to specify `runtime="python3.11"` to `python_aws_lambda_function` or `runtime="python311"` to `python_google_cloud_function`, as it will be inferred.
- New: for AWS Lambda targets, the `complete_platforms` argument now has default values provided by Pants, which gives more reliable builds, especially when building on a different platform than the AWS Lambda itself. This change also means that only one of the `complete_platforms` or `platforms` fields should be provided.

The new, faster parser for dependency inference is now the default, so the `[python-infer].use_rust_parser` option can be removed from `pants.toml`, if it is being explicitly set to `true`. The old parser is deprecated and will be removed: follow the warnings in 2.17 to move to the new parser.

The [new `pants.backend.experimental.python.typecheck.pytype` backend](https://www.pantsbuild.org/v2.18/docs/reference-pytype) allows running the `pytype` type checker as part of the `check` goal.

raw: Remove the old Python tool lockfile functionality. (#19218)

Numerous other features and bug fixes:

- The `tailor` goal now supports automatically creating `python_requirements` targets for in `pyproject.toml` files that follow [PEP 621 to specify dependencies](https://peps.python.org/pep-0621/#dependencies-optional-dependencies).
- Imports within a `with contextlib.suppress(ImportError): ...` construct are now considered weak imports.
- The global coverage report now correctly handles namespaced packages.
- `pex_binary` targets that consume `python_distribution` targets now work with just the distributions, not their transitive dependencies (the files that are used to build the distribution).
- Pants now emits an error if `isort` cannot read its configuration file (NB. `isort` itself emits warnings for this, but they would not be visible when running `isort` under the default Pants configuration).

Some deprecations have expired and the supporting code has been removed:

- the "old style" tool lockfiles are no longer supported, and instead customising the versions/installation of tools like `black`, `mypy` and `pytest` should configure [a "normal" resolve](https://www.pantsbuild.org/v2.18/docs/python-lockfiles#lockfiles-for-tools)
- using `pants export` without a `--resolve` flag is no longer supported, always pass that flag

#### Go

Memory usage has been reduced.

Go processes are now cached using the full version of the Go compiler (for example, `go1.20.6`) so that artifacts are not incorrectly reused between different patch versions.

#### JVM

The deprecation for the `excludes` field on `jvm_artifact` has expired, use `exclusions` instead.

#### NEW: Rust

The new `pants.backend.experimental.rust` backend has been added, with support for using `rustfmt` to format Rust source files.

#### Scala

The new `scala_artifact` target can be used to track third-party artifacts from Scala, with Pants then understanding how Scala artifacts include the Scala version in their coordinates.

#### Shell

The `shellcheck` binary for [the `pants.backend.shell.lint.shellcheck` backend](https://www.pantsbuild.org/v2.18/docs/shell#shellcheck-linter) is now fetched from `vscode-shellcheck`, and thus now supports AArch64 macOS (Apple Silicon) natively.

The deprecations for the pre-2.16 target names have expired, and thus these have been removed:

- `experimental_shell_command`: use `shell_command`
- `experimental_run_shell_command`: use `run_shell_command`

#### Terraform

A [new `experimental-deploy` goal](https://www.pantsbuild.org/v2.18/docs/reference-experimental-deploy) has been added, which supports

A new `pants.backend.experimental.terraform.lint.tfsec` backend has been added to run the `tfsec` linter as part of the `lint` goal.

Rawrepl: Add tfsec linter for Terraform (#19525)

raw: Terraform: Add experimental-deploy and wire-in dependency inference (#19185)

raw: Run terraform init as part of check goal (#18974)

#### Visibility

[The `pants.backend.experimental.visibility` backend](https://www.pantsbuild.org/v2.18/docs/validating-dependencies) is now also runs as a linter, such as when running `pants lint ::`, to report all visibility violations at one time.

Visibility rules about dependencies in the root of the repository are now supported.

### Plugin API Changes

raw: Resolve pants_requirements from direct wheel links to GitHub Release assets (#19432)

raw: Support per backend requirements (#19406)

raw: Remove deprecated PythonBinary type. (#19399)

raw: Add TraverseIfNotPackageTarget deps traversal predicate for use in plugins (#19306)
raw: Replace include_special_cased_deps flag with should_traverse_deps_predicate (#19272)

raw: store stdout/stderr output from tests as bytes (#19184)

raw: Simplify interpreter-related CI config. (#19096)

raw: Allow the usage of digits in named cache names (#19052)

The deprecations for many request types has expired (follow instructions in warnings in 2.17 to resolve), so they are now removed: `AllAssetTargetsRequest`, `AllTargetsRequest`, `BashBinaryRequest`, `CatBinaryRequest`, `CGoCompilerWrapperScriptRequest`, `ChmodBinaryRequest`, `DiffBinaryRequest`, `DjangoAppsRequest`, `DockerBinaryRequest`, `GitBinaryRequest`, `GunzipBinaryRequest`, `MkdirBinaryRequest`, `ReadlinkBinaryRequest`, `TarBinaryRequest`, `UnzipBinaryRequest`, `ZipBinaryRequest`

## Full Changelog

For the full changelog, see the individual GitHub Releases for this series: https://github.com/pantsbuild/pants/releases
