#!/usr/bin/env bash

set -euo pipefail

requirements_file=3rdparty/python/requirements.txt
constraints_file=3rdparty/python/constraints.txt

VENV=$(mktemp -d -t pants_lockfile_venv.XXXXX)
virtualenv "${VENV}"
"${VENV}/bin/pip" install -r "${requirements_file}"
echo "# Generated by build-support/bin/generate_lockfile.sh on $(date)" > "${constraints_file}"
"${VENV}/bin/pip" freeze --all >> "${constraints_file}"
